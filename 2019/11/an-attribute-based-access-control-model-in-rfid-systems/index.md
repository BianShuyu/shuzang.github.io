# An Attribute-Based Access Control Model in RFID Systems


## 系统架构

基于以太坊区块链，使用ABAC模型。物理节点包括RFID Reader Control(RFID-RC)，DApp和智能合约。当一个带有RFID标签的医疗器械尝试访问房间时，RFID-RC发送访问请求到DApp，DApp查询智能合约返回与资产相关的属性（例如公司前缀，产品类型，序列号等），同时，DApp还会从RFID-RC获取其它的属性如时间戳。然后，DApp基于属性来执行安全策略，决定来自标签的访问是允许还是拒绝。

## 访问控制机制

要使主体能够对对象执行策略（例如，允许或拒绝访问），必须启用ABAC访问控制机制（ACM）。ACM包括以下几步

1. 检查主体属性
2. 检查访问控制策略（规则）
3. 检查对象属性
4. 检查环境信息

尽管预期主体是人是正常的，但诸如自主服务或应用程序等非人实体（npe）也可以作为主体这一角色。在我们的例子中，Reader向DApp请求访问RFID标签。

在分析访问控制策略之前，为将资产从源房间（如灭菌区）转移到目的房间（如手术室）建立了一些边界条件，反之亦然：

1. 授权资产转移的交易由授权员工通过连接到DAPP的可信应用程序调用（图4）

2. 标签使用的EPC（电子产品代码）的模式与表达式（1）相似，并在表达式（2）中进行了说明：

   Header|公司前缀|产品类型|序列号

访问控制的过程如下所述

1. 基于两个属性：reader name(变量01：“rdr_name", 例如，rdr_nm:"roomA")和位置(变量02：”loc", 例如，loc：“41.40338，2，17403”)验证主体(reader)
2. 验证其它属性：公司前缀（变量 03: “cmp_prf”,例如， cmp_prf: 000389），产品类型（(变量 04: "item_ref", 例如, item_ref: 000162），指定资产的序列号（变量 05: “ser_nmb”, 例如, ser_nmb: 000169740），以及资产状态（变量 06: “st”, 例如, st: “STERILIZED”）
3. 环境条件是根据在医疗室（通过交易）向现有阅读器发送资产时所经过的时间来验证的。并且Reader接收对该资产(标签)的访问请求。如果间隔小于10分钟（600秒），则环境条件验证通过。这一时间设置用于调用交易后在两个位置间移动资产。从这个意义上说，变量07:“time_-In”（例如time_-In:156209335）是交易完成后的时间记录，变量08:“time_-out”（例如time_-out:156209455）是Reader请求访问此RFID标签时给定的时间。

在表达式3中定义访问控制策略C

if  (rdr_nm = "roomA" ∩ loc = "41.40338, 2.17403." ∩ cmp_pfr = 000389 ∩ iem_ref = 000162 ∩ ser_nmb = 000169740 ∩ st = "STERILIZED" ∩ time_out − time_in ≤ 600)，true

otherwise ,false

## 技术实施细节

表4总结了每个子系统及其相关模块使用的技术，共有三个子系统：ABAC 配置，ABAC执行和以太坊监控

### ABAC配置

ABAC配置子系统包括一个基于React构建的GUI，通过浏览器交互，有两个视图，第一个视图允许授权用户添加新资产，授权用户将公司前缀、产品类型、资产序列号等参数输入系统，并随之生成交易存储在区块链中。第二个视图用于转移资产，授权用户首先通过查询智能合约验证资产序列号，这一操作通过点击“Verify iD"按钮完成，然后就可以在两个房间转移资产，之前的资产属性如资产状态、时间戳都会更新，资产转移操作通过点击”Transfer asset“按钮完成。这些操作的细节在接下来其它的子系统中详细解释

### ABAC执行

ABAC执行子系统可以允许或拒绝对资产的访问请求，该子系统布置在每个医疗室内。子系统的部件包括RFID reader，LLRP服务器，属性解析器（AP），ABAC安全策略和区块链接口。后三者构成DApp访问控制执行系统。

RFID reader直接与贴了标签的资产以及LLRP服务器交互，LLRP是epc global批准的一种协议，它是构成reader与其软件或控制硬件之间接口的标准。

属性解析器从LLRP服务器收到RFID标签的电子产品代码，然后使用一个基于Node.js库的GTIN转换系统，将RFID标签的电子产品代码转换成统一资源标识符URI。属性解析器解析其中的属性，得到公司前缀、产品类型和序列号，同时，属性解析器也控制其它的属性如时间戳、reader name和位置。

区块链接口构建基于truffle框架，使用drizzle库与web3.js服务器交互，drizzle是一个编写DApp前端的前端库集合。DApp和RFID部分通过执行GET和POST方法通信，例如，ABAC安全策略确定是否允许或拒绝对资产的访问，它设置一个变量，该变量通过POST方法发送到LLRP服务器。因此，LLRP服务器发送一个xml“keepalive”消息来维护与RFID标签的交互，或者只是断开它。

### 区块链监控

使用了ETH Network Stats项目

## 评估方案的可行性

使用了两个环境评估方案可行性，一个是本地区块链，一个是测试链Ropsten。

### 评估工具

主要是ETH Network Stats，Etherscan，Truffle Test和Infura Dashboard。

ETH Network Stats是一个追踪以太坊网络状态的可视化工具，使用WebSockets来接收运行节点的数据并通过界面显示，可以在本地单独运行。

Etherscan是一个监控区块链和其上交易状态的工具，可以部署在本地

### 测量

通过各种工具能测量各种单独的参数，因此考虑如何分析整体的性能


