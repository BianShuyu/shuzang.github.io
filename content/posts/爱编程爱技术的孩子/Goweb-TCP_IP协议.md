---
title: TCP/IP协议基础
date: 2018-09-15T15:44:00+08:00
tags: [Golang]
categories: [爱编程爱技术的孩子]
typora-root-url: ..\..\..\static
---

## 1. 什么是TCP/IP协议

​	是针对网际网所开发的一种互联通信协议, 目的在于把网际各种异构网络或主机通过TCP/IP实现互联

**特点**：

- 支持异构：异构的计算机（指的是底层指令集不同的计算机），异构的操作系统（如windows和MAC os），异构的网络
- 效率低

## 2. TCP/IP的层次结构

![TCP_IP协议基础](/images/Goweb-TCP_IP协议/3EEC0s.png)



## 3. MAC地址与IP地址

#### 3.1 MAC地址

物理地址，是属于IEEE MAC层的地址

例子：802.3   48位（全局分配，唯一）

​	    Orchid：Pcnet  8位（用户自设）

特点：不同的LAN具有不同格式的MAC地址，不能作为全局地址寻址

#### 3.2 IP地址

是Internet地址，网络地址+主机地址构成，共32位

分为A、B、C、D、E五类，常用前三类，D类是组播地址，E类是保留地址

注：E类保留地址不等于私有地址，私有地址位于A、B、C三类中，用于NAT地址转换

#### 3.3 特殊的IP地址

- 主机地址为0的IP地址指本网络
- 主机地址为全1的IP地址为广播(保留)
- 全0: 本主机(仅在启动时用,不可作为目的)
- 网络地址为0: 本网上的主机
- 网络地址为127:回送地址,用于测试

#### 3.4 IP地址的缺陷和表示

- 缺陷：主机从一个网络切换到另一个网络必须改变IP地址
  - 多址主机会产生一些问题
- 表示：点分十进制表示法

#### 3.5 MAC地址与IP地址的关系

在两个网络间的主机通信时，源IP和目的IP地址永远不变，但MAC地址会由路由器操作不断改变指向下一跳的路由器或主机

## 4. 解决IPv4地址空间不足的方法

子网、超网、NAT地址转换、IPv6

#### 4.1 子网和超网

子网是网络地址从主机地址借位

超网是主机地址从网络地址借位，如多个C类地址可借此方法合并从而扩大IP地址范围

*注：以上两种方法叫做无类域间路由（CIDR，Classless Inter Domain Routing)*

斜线记法：A.B.C.D/n。n表示掩码1的位数

#### 4.2 NAT地址转换

这一任务由边界路由器完成，同时，NAT的完成方式有三种：

- Static NAT：一对一的地址转换，看起来这种情况直接用IP地址就好，使用NAT多此一举，实际上这种方式能保证内网设备不被攻击
- Dynamic NAT：一对一的转换，但是在边界路由器那里是一个地址池，谁来谁用，局域网拥有的总IP数小于网络设备数
- PAT（Overload）：所有设备对外是一个IP，对内边界路由器使用端口号区分设备，这种方式慢，且不支持DNS

#### 4.3 IPv6

用了一个128位长的地址，足够所有人用了

## 5. ARP协议

该协议是IP地址到MAC地址转换时用的

- 一般的映射方法：IP地址与MAC地址的关系固定，在系统中设置一个表，记录它们的关系
- Internet中的方法：动态绑定(Binding)，通过ARP(address Resolution Protocol)实现

过程：A已知B的IP地址，找B的MAC地址。针对物理网络（即LAN）可以广播的特点，A发出一个广播报文（APR报文），B收到后给出一个回答（单播）

APR使用缓存技术，这里是一些注意点：

- 缓存中放置IP地址与MAC地址的对应关系表
- 源站广播APR请求时报文中包含自己的IP地址和MAC地址，LAN上所有的站都能收到，并放入缓存表，这一机制大大减少了工作量
- 新机入网时，主动广播自己的IP地址和MAC地址
- 缓存是动态的，有时间限制

**APR报文**

## 6. RARP协议

逆地址解析协议，作用是使只知道自己硬件地址的主机能通过RARP协议找出其IP地址，现在的DHCP协议已经包含了其全部功能