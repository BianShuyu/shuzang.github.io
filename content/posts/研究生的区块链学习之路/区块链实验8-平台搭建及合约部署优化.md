---
title: 区块链实验8-平台搭建及合约部署优化
date: 2020-05-26
lastmod: 2020-05-26
tags: [科研记录]
categories: [研究生的区块链学习之路]
slug: Platform building and contract deployment optimization
typora-root-url: ..\..\..\static
---

## 实验设计

之前的实验中没有得到更具体的实验结果，而且手动编辑配置文件、创建节点、组建网络实在是一件耗费时间而且错误率较高的事情，现有的 Quorum 网络浏览器也都不支持直接建立在宿主机的Quorum网络上，而是建立在 Docker 集群上。所以，为了更好的进行实验和得到结果，新的实验使用 Docker 集群建立 Quroum 网络，使用开源工具 [quorum-maker](https://github.com/synechron-finlabs/quorum-maker/tree/master/lib) 可以简化网络搭建的流程。

利用 quorum-maker 建立基于 Docker 的 Quorum 网络，由于该工具暂时不支持 IBFT 共识算法，我们只能使用 Raft 共识。树莓派作为轻节点加入已有 Quorum 网络，职责是普通 IoT 设备的代理。同时，quorum-maker 提供了 Web UI  作为区块链浏览器，可查询关于区块、交易和合约的相关信息，满足我们的基本需求。

接下来确认我们需要测量的值

1. 智能合约部署的 Gas 消耗和时间消耗：这些值看起来测量没有意义，但作为一种常用测量值和人们通常关注的方面，简单的给出结果；
2. 惩罚函数的值随时间的变动：虽然没有想通的一件事是函数给出后，变动曲线可以随之画出来，其趋势是可知的，为什么还要测量具体的值。但别的论文都这么做而且绘制图表，看起来是大家都关心的方面，所以作为待测量的一个方面；
3. 进行一次访问控制的时间消耗：这是最重要也最有必要的一件事，我们可以确定 ABAC 模型相比于传统的 ACL 是更加物联网友好的，但对于同样的 ABAC 设计实现，究竟哪种结构实施访问控制比较快，还有待验证，这也是做物联网访问控制人们最关心的一件事。

合约部署消耗很容易可以得到，关于惩罚函数的值在确定相关权重值后也可以得到，而访问控制的时间消耗，我们可以将其看作调用 AccessControl() 合约函数的交易执行时间。现有的难点是网络搭建方面的，即树莓派如何连接到 宿主机 Docker 集群构成的 Quorum 网络的问题。

简单的进行接下来的时间规划

1. 完善现有合约设计，实现惩罚函数（两周）
2. 使用 quorum-maker 基于 Docker 搭建 Quorum 网络，并将树莓派作为轻节点连接（两周）
3. 部署合约并获得相关测量结果

事实上，实际的测试过程接下来就可以执行测试了，Subject 首先根据设备的区块链地址从 MC 中获取设备的 ACC 合约地址，或者直接从网络获取设备管理者公布的 设备 ACC 合约地址，然后发起调用 accessControl() 函数，传入参数为要访问的资源和要执行的操作。返回的结果为 true 或 false，同时，调用者地址、结果、结果说明、访问时间等会通过事件发送出去，可以在 Js 中通过调用事件查看。